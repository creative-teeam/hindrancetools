<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>子どもの特性・配慮ガイド</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>子どもの特性・配慮ガイド（演劇・ワークショップ向け）</h1>
    <p>病名・障害・特性、対応チェックリスト、対応フローを現場に合わせて随時追加できます。</p>
  </header>

  <main>
    <!-- 0. 病名・障害・特性 一覧＆追加 -->
    <section class="card">
      <h2>0. 病名・障害・特性 一覧（随時追加・編集可）</h2>
      <p>
        対象となる病名・障害・特性を一覧として管理します。<br />
        右側のフォームから新しい項目を追加できます。<br />
        一覧から選ぶと、内容を編集して上書き保存できます。
      </p>

      <div class="flex-row">
        <!-- 左：一覧 -->
        <div class="list-block">
          <h3>登録済みリスト</h3>
          <ul id="diagnosisList" class="item-list">
            <!-- JSで追加 -->
          </ul>
        </div>

        <!-- 右：追加フォーム -->
        <div class="form-block">
          <h3>新しい病名・障害・特性を追加</h3>
          <label for="diagName">名前（必須）：</label>
          <input
            type="text"
            id="diagName"
            placeholder="例：自閉スペクトラム症（ASD）、ADHD、学習障害 など"
          />

          <label for="diagNotes">
            現時点で分かっている情報・配慮のメモ（任意）：
          </label>
          <textarea
            id="diagNotes"
            rows="4"
            placeholder="例：大きな音が苦手／女の子との距離感に注意／発作時は保護者に連絡 など"
          ></textarea>

          <button id="addDiagnosisBtn">一覧に追加</button>
        </div>
      </div>

      <div id="diagnosisDetail" class="info-block hidden">
        <div class="info-section-title">選択された病名・障害・特性の編集</div>
        <label for="diagnosisDetailNameInput">名前：</label>
        <input type="text" id="diagnosisDetailNameInput" />

        <label for="diagnosisDetailNotesInput">メモ：</label>
        <textarea id="diagnosisDetailNotesInput" rows="4"></textarea>

        <button id="updateDiagnosisBtn" class="sub-btn">この内容で更新</button>

        <p class="small-text" style="margin-top:0.6rem;">
          ※ここで編集した内容は、0番の一覧にそのまま反映されます。
        </p>
      </div>
    </section>

    <!-- 1. 対応表・チェックリスト 一覧＆追加 -->
    <section class="card">
      <h2>1. 対応表・チェックリスト（随時追加・編集可）</h2>
      <p>
        「どんな状況のときに」「どんな対応をするか」を項目ごとに登録できます。<br />
        一覧から選ぶと、内容を編集して上書き保存できます。
      </p>

      <div class="flex-row">
        <!-- 左：対応表一覧 -->
        <div class="list-block">
          <h3>登録済みの対応・チェック項目</h3>
          <ul id="responseList" class="item-list">
            <!-- JSで追加 -->
          </ul>
        </div>

        <!-- 右：追加フォーム -->
        <div class="form-block">
          <h3>新しい対応・チェック項目を追加</h3>
          <label for="respTitle">項目名（必須）：</label>
          <input
            type="text"
            id="respTitle"
            placeholder="例：大きな音が苦手な子への配慮"
          />

          <label for="respBody">
            内容・具体的な対応（必須）：
          </label>
          <textarea
            id="respBody"
            rows="4"
            placeholder="例：音出しの前に必ず予告する／耳栓OKにする／しんどそうなら一時退室を認める など"
          ></textarea>

          <label for="respLevel">
            重要度・種類（任意）：
          </label>
          <select id="respLevel">
            <option value="">未指定</option>
            <option value="danger">danger（安全上の危険）</option>
            <option value="support">support（見守り・配慮）</option>
            <option value="medical">medical（医療・健康面）</option>
          </select>

          <button id="addResponseBtn">対応表に追加</button>
        </div>
      </div>

      <div id="responseDetail" class="info-block hidden">
        <div class="info-section-title">選択された対応・チェック項目の編集</div>
        <label for="responseDetailTitleInput">項目名：</label>
        <input type="text" id="responseDetailTitleInput" />

        <label for="responseDetailBodyInput">内容：</label>
        <textarea id="responseDetailBodyInput" rows="4"></textarea>

        <label for="responseDetailLevelSelect">重要度：</label>
        <select id="responseDetailLevelSelect">
          <option value="">未指定</option>
          <option value="danger">danger（安全上の危険）</option>
          <option value="support">support（見守り・配慮）</option>
          <option value="medical">medical（医療・健康面）</option>
        </select>

        <button id="updateResponseBtn" class="sub-btn">この内容で更新</button>
      </div>
    </section>

    <!-- 2. 親の付き添い必須ラインチェックリスト -->
    <section class="card">
      <h2>2. 親の付き添い必須ラインチェックリスト</h2>
      <p>
        日常生活と学校生活の様子をもとに、付き添いが必要かどうかの目安を確認します。<br />
        チェック項目と判定コメントテンプレは追加・編集して使えます。
      </p>

      <div class="flex-row">
        <!-- 左：実際のチェックリスト -->
        <div class="checklist-block large">
          <h3>日常生活・学校生活での様子</h3>

          <div class="checklist-container">
            <div class="checklist-block inner">
              <h4>日常生活</h4>
              <form id="dailyChecklist">
                <label>
                  <input type="checkbox" name="daily" value="danger" />
                  目を離すとすぐにどこかへ行ってしまう・迷子になりやすい
                </label>
                <label>
                  <input type="checkbox" name="daily" value="danger" />
                  危険な場所（道路・高いところ・台所など）に繰り返し行ってしまう
                </label>
                <label>
                  <input type="checkbox" name="daily" value="support" />
                  知らない人との距離感が近すぎる・身体に触ってしまう
                </label>
                <label>
                  <input type="checkbox" name="daily" value="support" />
                  強いこだわりやパニックがあり、家族でないと落ち着かせるのが難しい
                </label>
                <label>
                  <input type="checkbox" name="daily" value="medical" />
                  発作やアレルギーなど、医療的な緊急対応が必要になる可能性がある
                </label>
              </form>
              <button id="addDailyItemBtn" class="sub-btn">
                日常生活の項目を追加
              </button>
            </div>

            <div class="checklist-block inner">
              <h4>学校生活・集団活動</h4>
              <form id="schoolChecklist">
                <label>
                  <input type="checkbox" name="school" value="support" />
                  授業中に席を立って歩き回ることがよくある
                </label>
                <label>
                  <input type="checkbox" name="school" value="support" />
                  先生から「1対1のサポートがあると安心」と言われている
                </label>
                <label>
                  <input type="checkbox" name="school" value="danger" />
                  他の子を押す・叩く・強く抱きつくなどの行動が繰り返し見られる
                </label>
                <label>
                  <input type="checkbox" name="school" value="support" />
                  からかわれやすい／トラブルに巻き込まれやすいと言われている
                </label>
                <label>
                  <input type="checkbox" name="school" value="medical" />
                  学校で医療的ケア（発作対応・エピペン・吸入など）の準備をしている
                </label>
              </form>
              <button id="addSchoolItemBtn" class="sub-btn">
                学校生活の項目を追加
              </button>
            </div>
          </div>

          <button id="evaluateChecklist">付き添いの必要度を判定</button>
          <div id="checklistResult" class="info-block hidden"></div>
        </div>

        <!-- 右：判定テンプレ一覧＋追加 -->
        <div class="form-block">
          <h3>判定結果テンプレを管理</h3>
          <p class="small-text">
            付き添い「必須」「推奨」「不要」などのコメントテンプレを登録しておき、<br />
            判定結果に合わせて選んで表示できます。
          </p>

          <label for="resultTemplateSelect">テンプレートを選択：</label>
          <select id="resultTemplateSelect">
            <!-- JSで追加 -->
          </select>

          <label for="resultTemplateBody">テンプレート内容：</label>
          <textarea
            id="resultTemplateBody"
            rows="5"
            placeholder="ここにテンプレ内容が表示されます"
          ></textarea>

          <button id="applyTemplateBtn" class="sub-btn">
            判定結果にこのテンプレを反映
          </button>

          <hr />

          <h4>新しいテンプレを追加</h4>
          <label for="newTemplateName">テンプレ名：</label>
          <input
            type="text"
            id="newTemplateName"
            placeholder="例：付き添い原則必須（医療リスクあり）"
          />

          <label for="newTemplateBody">内容：</label>
          <textarea
            id="newTemplateBody"
            rows="4"
            placeholder="例：医療的なリスクがあるため、必ず保護者または支援者の付き添いをお願いします。..."
          ></textarea>

          <button id="addTemplateBtn">テンプレを追加</button>
        </div>
      </div>
    </section>

    <!-- 3. その場の対応フロー（既存＋カスタム追加） -->
    <section class="card">
      <h2>3. その場の対応フロー</h2>
      <p>
        トラブルや心配な行動が出たときの流れを確認します。<br />
        既存パターンに加え、任意の「カスタムフロー」を追加できます。
      </p>

      <div class="flex-row">
        <!-- 左：選択＋表示 -->
        <div class="list-block">
          <label for="incidentType">状況を選んでください：</label>
          <select id="incidentType">
            <option value="">選択してください</option>
            <option value="immediateDanger">
              【既存】身体の危険がある
            </option>
            <option value="psychological">
              【既存】他の子が怖がっている・不安
            </option>
            <option value="ruleBreak">
              【既存】ルール違反が何度も続く
            </option>
            <option value="medicalEmergency">
              【既存】医療的な緊急事態
            </option>
            <!-- カスタムはJSで追加 -->
          </select>

          <div id="incidentFlow" class="info-block hidden"></div>
        </div>

        <!-- 右：カスタムフロー追加 -->
        <div class="form-block">
          <h3>カスタム対応フローを追加</h3>
          <label for="customFlowName">フロー名（必須）：</label>
          <input
            type="text"
            id="customFlowName"
            placeholder="例：稽古開始前に落ち着きがないとき"
          />

          <label for="customFlowBody">
            手順・対応内容（必須）：
          </label>
          <textarea
            id="customFlowBody"
            rows="6"
            placeholder="例：1) 入口で迎える担当を決めておく\n2) 会場に入る前に今日の流れを短く説明する\n3) ..."
          ></textarea>

          <button id="addCustomFlowBtn">カスタムフローを追加</button>
        </div>
      </div>
    </section>

    <!-- 4. メモ欄＋メモログ -->
    <section class="card">
      <h2>4. メモ欄（団体ごとのルール・気づきの記録）</h2>
      <p>
        稽古や本番で気づいたこと、保護者と話して決めたルールなどを自由にメモしてください。<br />
        「保存する」ボタンを押すと、このメモ内容が「ログ」として日時付きで下に追加されます。<br />
        ログは後から編集・削除できます。
      </p>
      <label for="freeMemo">自由メモ（現在の下書き）：</label>
      <textarea
        id="freeMemo"
        rows="6"
        placeholder="例：〇月〇日 初参加。○○の場面でパニックになりかけたが、□□の声かけで落ち着いた。次回も同じ対応を試してみる。"
      ></textarea>

      <div id="memoLogContainer" class="info-block" style="margin-top:1.2rem;">
        <div class="info-section-title">メモログ一覧（保存されたもの）</div>
        <div id="memoLogList">
          <!-- JSでログを追加 -->
        </div>
        <p class="small-text">
          ※ログに残るのは、このメモ内容と日時のみです。0〜3の追加内容はログには残さず、リストにそのまま保持します。
        </p>
      </div>
    </section>
  </main>

  <footer>
    <p>
      ※このツールは現場スタッフの話し合いのたたき台として設計されています。
      実際の運用は必ず団体内で検討・調整してください。
    </p>
  </footer>

  <!-- 保存ボタン（画面右下固定） -->
  <button id="saveAllBtn" class="floating-save-btn">
    保存する
  </button>

  <script src="app.js"></script>
</body>
</html>
